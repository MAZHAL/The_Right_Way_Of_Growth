# TCP 与 UDP 


## TCP 
- 定义：传输控制协议。是一种面向连接的、可靠的、基于字节流的传输层通信协议。
- 存在的原因：应用层需要可靠的连接，但是IP层没有这样的流机制
- 面向连接：即在客户端和服务器之间发送数据之间，必须先建立连接
- 连接需要建立三次握手、四次挥手断开连接
- 优点：可靠，稳定 
- 缺点：慢，效率低，占用系统资源高
- 应用场景 ； 少量数据
>  如果传输文件等，不能丢包，用TCP

## UDP
- 定义： 用户数据报协议。是一个简单的面向数据报的传输层协议
- 无连接的数据报协议：发送数据之前不需要先建立连接
- 功能：为了在给定的主句上能识别多个目的的地址，同时允许多个应用程序在同一台主句上工作并能够独立地进行数据包的发送和接受，设计用户数据报协议UDP
- 优点：快，比TCP稍安全 UDP没有TCP的握手、确认、窗口、重传、拥塞控制等机制
- 缺点：不可靠，不稳定 因为UDP没有TCP那些可靠的机制，在数据传递时，如果网络质量不好，就会很容易丢包
- 应用场景； 传输大量数据 
> 普通的会议视频图像，当然首选UDP，毕竟丢几包无所谓。



## UDP有时比TCP更有优势?
- UDP以其简单、传输快的优势，在越来越多场景下取代了TCP,如实时游戏。  
>（1）网速的提升给UDP的稳定性提供可靠网络保障，丢包率很低，如果使用应用层重传，能够确保传输的可靠性。  
（2）TCP为了实现网络通信的可靠性，使用了复杂的拥塞控制算法，建立了繁琐的握手过程，由于TCP内置的系统协议栈中，极难对其进行改进。
采用TCP，一旦发生丢包，TCP会将后续的包缓存起来，等前面的包重传并接收到后再继续发送，延时会越来越大，基于UDP对实时性要求较为严格的情况下，采用自定义重传机制，能够把丢包产生的延迟降到最低，尽量减少网络问题对游戏性造成影响。  
 
##  为什么TCP不适用于实时传输？
TCP影响实时性不是因为握手消耗时间。握手一开始建立完就没事了
一般来说，单位时间内传输的数据流量比较平滑。 TCP依赖滑动窗口进行流量控制，滑动窗口大小是自适应的，影响滑动窗口主要有两个因素，一是网络延时，二是传输速率，滑动窗口的大小与延时成正比，与传输速率也成正比。在给定的网络环境下，延时可以认为是固定的，因此滑动窗口仅与传输速率有关，当传输实时数据时，因为数据流通量比较固定，所以这时TCP上的滑动窗口会处于一个不大不小的固定值，这个值大小恰好保证当前生产的数据实时传输到对方，当出现网络丢包时，按TCP协议（快速恢复），滑动窗口将减少到原来的一半，因此速率立刻减半，此时发送速率将小于数据生产速率，一些数据将滞留在发送端，然后滑动窗口将不断增大，直到积累的数据全部发送完毕。上述过程即为典型的TCP流量抖动过程，对于实时传输影响很大，可能形成较大的突发时延，从用户感观角度来说，就是有时比较流畅，但有时卡（“抖一下”，并且比较严重），因此实时传输通常不使用TCP。


## 总结
1、TCP面向连接（如打电话要先拨号建立连接）;UDP是无连接的，即发送数据之前不需要建立连接  
2、TCP提供可靠的服务。也就是说，通过TCP连接传送的数据，无差错，不丢失，不重复，且按序到达;UDP尽最大努力交付，即不保   证可靠交付  
3、TCP面向字节流，实际上是TCP把数据看成一连串无结构的字节流;UDP是面向报文的
  UDP没有拥塞控制，因此网络出现拥塞不会使源主机的发送速率降低（对实时应用很有用，如IP电话，实时视频会议等）  
4、每一条TCP连接只能是点到点的;UDP支持一对一，一对多，多对一和多对多的交互通信  
5、TCP首部开销20字节;UDP的首部开销小，只有8个字节  
6、TCP的逻辑通信信道是全双工的可靠信道，UDP则是不可靠信道  
 